<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    
    <!--Chart.js-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.5.0/dist/chart.min.js"></script>

    <title>The People vs Covid-19</title>

    <!--Fonts and styles-->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,700,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tienne&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./style.css">
    <link href="/your-path-to-fontawesome/css/solid.css" rel="stylesheet">

    <!-- Icons -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <!--Google Maps Script-->
    <script defer 
        src="https://maps.googleapis.com/maps/api/js?key=&callback=initMap">
    </script>
  </head>
  <body>
    <section class="content">

        <div class="d-flex justify-content-center title-container">
            <span class="title">The People <span style="color:white; font-size: smaller;"> vs </span>Covid-19</span>
        </div>
        
        <div class="map">
            <div class="container">
                <div class="row d-flex justify-content-center" style="margin-left:-10%;">
                    <!--to be replaced, static data-->
                    <div class="col-md-auto">
                        <ul>
                            <li><p class="text-center">total confirmed cases</p></li>
                            <li><p class="text-center numbers" id="confirmed-cases"></p></li>
                        </ul>
                    </div>
                    <div class="col-md-auto">
                        <ul>
                            <li><p class="text-center">total deaths</p></li>
                            <li><p class="text-center numbers" id="total-deaths"></p></li>
                        </ul>
                    </div>
                    <div class="col-md-auto">
                        <ul>
                            <li><p class="text-center">total recovered</p></li>
                            <li><p class="text-center numbers" id="total-recovered"></p></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="container navigate-down">
            <div class="d-flex justify-content-center">
                <p id="current-date"></p>
            </div>
            <div class="d-flex justify-content-center">
                <button onclick="refreshData()" type="button" class="btn btn-outline-light" id="refresh-btn">
                    Refresh Data
                </button>
            </div>
            <div id="tool" class="container tool">
                <div class="row justify-content-center">
                    <h2 style="margin-bottom: 20px;">Live Map</h2>
                </div>
                <div class="row">
                    <div id="map" style="width: 100vw; height: 100vh;"></div>
                    <div id="tooltip"></div>
                </div>
            </div>
            <div class="d-flex justify-content-center arrow">
                <ion-icon name="chevron-down" alt="arrow down" class="arrow-icon" id="navigate"></ion-icon> 
            </div>
        </div>


        <div class="container cases">
            <div class="d-flex justify-content-center">
                <div class="row"></div>
                <h2>Coronavirus disease 2019 (COVID-19)</h2>
                </div>

                <div class="row justify-content-center">
                    <p class="text-center w-75">is defined as an illness caused by a novel coronavirus known as severe acute respiratory 
                        syndrome coronavirus 2 (SARS-CoV-2; formerly known as 2019-nCoV). It was discovered after an
                        outbreak of respiratory sickness cases in Wuhan City, Hubei Province, China.</p>
                </div>

                <div class="row justify-content-center">
                    <canvas id="chart"></canvas>
                </div> 
            </div>
        </div>

        <div class="container dashboard">
            <div class="row justify-content-center">
                <p class="text-center" style="font-size: 24px; font-weight:100; width:95%">
                    It was on <span style="font-size:xx-large; font-weight:300">March 11, 2020</span>, the WHO declared COVID-19 a global pandemic, its first such designation since declaring H1N1 
                    influenza a pandemic in 2009.
                </p>
            </div>

            <div class="row justify-content-center">
                <div class='tableauPlaceholder' id='viz1627830014490' style='margin-left:6%;'>
                    <noscript>
                    <a href='#'><img alt='Dashboard 1 ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Co&#47;Covid-19Dashboard_16278297326670&#47;Dashboard1&#47;1_rss.png' style='border: none' /></a>
                    </noscript>
                    <object class='tableauViz'  style='display:none;'>
                        <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
                        <param name='embed_code_version' value='3' /> 
                        <param name='site_root' value='' />
                        <param name='name' value='Covid-19Dashboard_16278297326670&#47;Dashboard1' />
                        <param name='tabs' value='no' />
                        <param name='toolbar' value='yes' />
                        <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Co&#47;Covid-19Dashboard_16278297326670&#47;Dashboard1&#47;1.png' /> 
                        <param name='animate_transition' value='yes' />
                        <param name='display_static_image' value='yes' />
                        <param name='display_spinner' value='yes' />
                        <param name='display_overlay' value='yes' />
                        <param name='display_count' value='yes' />
                        <param name='language' value='en-US' />
                        <param name='filter' value='publish=yes' />
                    </object>
                </div>                
                <script type='text/javascript'> 
                    var divElement = document.getElementById('viz1627830014490'); 
                    var vizElement = divElement.getElementsByTagName('object')[0];
            
                    if ( divElement.offsetWidth > 800 )
                    { vizElement.style.width='1024px';vizElement.style.height='795px';} 
                    else if ( divElement.offsetWidth > 500 ) { 
                        vizElement.style.width='1024px';vizElement.style.height='795px';
                    } 
                    else { 
                        vizElement.style.width='100%';vizElement.style.height='827px';
                        }                     
                        
                        var scriptElement = document.createElement('script');  
                        scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
                        vizElement.parentNode.insertBefore(scriptElement, vizElement);
                </script>
            </div>
        </div>

        <div class="container simulations">
            <div class="row">
                <h1 class="simulations-title">Flattening the Curve</h1>
            </div>

            <div class="row">
                <p style="font-size: 24px; font-weight: 100; width: 85%;">Because outbreaks of novel illnesses are unlikely to go away anytime soon, we must learn how we can prevent large outbreaks. Try out the simulation below to see how we can "flatten the curve" through vaccinations and social distancing. </p>
            </div>

            <div class="row">
                <div id="settings-panel">
                    <div class="col">
                        <button type="button" class="btn btn-light" id="start-btn">
                            Start
                        </button>
                    </div>
                    <div class="col d-flex justify-content-end">
                        <span class="slider">
                            <div>Population: <span id="pop-val">200</span></div>
                            <input type="range" id="pop-slider" max="200" min='10' value='200'>
                        </span>
                    </div>
                    <div class="col d-flex justify-content-end">
                        <span class="slider">
                            <div>Initial Infection Rate: <span id="infection-val">5</span>%</div>
                            <input type="range" id="infection-slider" max="100" min='0' value='5'>
                        </span>
                    </div>
                    <div class="col d-flex justify-content-end">
                        <span class="slider">
                            <div>Initial Vaccination Rate: <span id="vaccination-val">0</span>%</div>
                            <input type="range" id="vaccination-slider" max="100" min="0" value="0">
                        </span>
                    </div>
                    <div class="col d-flex justify-content-end">
                        <span class="slider">
                            <div>Social Distancing Rate: <span id="social-dist-val">0</span>%</div>
                            <input type="range" id="social-dist-slider" max="100" min="0" value="0">
                        </span>
                    </div>
                </div>
                <canvas id="canvas"></canvas>
                <script src="/src/sim/simController.js" type="module"></script>
                <div id="chart-panel">
                    <div id="chart-stats">
                        <span class="chart-stat">Healthy: <span id="stat-healthy">0</span></span>
                        <span class="chart-stat">Infected: <span id="stat-infected">0</span></span>
                        <span class="chart-stat">Recovered: <span id="stat-recovered">0</span></span>
                    </div>
                    <div id="chart-dimensions">
                        <canvas id="chart-canvas"></canvas>
                        <!--Required Chart script to initialize-->
                        <script src="/src/sim/chart.js" type="module"></script>
                    </div>
                </div>  
            </div>
        </div>
    </section>

    <!--Required Webpack Main Script-->
    <script src="main.js"></script>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <!--Live Covid-19 Tracker-->
    <script>
        init();
                
        function init() {
            var url = "https://covid19.mathdro.id/api";
            var today = new Date();

            var date = 'as of ' + today;
            document.getElementById("current-date").innerHTML = date;

            var data = '';

            $.get(url, function(data){
                document.getElementById('confirmed-cases').innerHTML = data.confirmed.value.toLocaleString("en-US");
                document.getElementById('total-deaths').innerHTML = data.recovered.value.toLocaleString("en-US");
                document.getElementById('total-recovered').innerHTML = data.deaths.value.toLocaleString("en-US");
            });
        }

        function clearData() {
            $("#confirmed-cases").empty();
            $("#total-deaths").empty();
            $("#total-recovered").empty();
        }

        function refreshData() {
            clearData();
            init();
        }
        </script>
  
        <script>
            const api = "https://disease.sh/v3/covid-19/historical/all?lastdays=557";

            const getData = async () => {
                const response = await fetch(`${api}`);
                if (response.ok) {
                    return await response.json();
                } else {
                    return Promise.reject(response.status);
                }
            };
            
            const result = getData();
            result.then((data) => {
                let date = Object.keys(data.cases);
                let total = Object.values(data.cases);
                let deaths = Object.values(data.deaths);
                let recovered = Object.values(data.recovered);
            
                var ctx = document.getElementById('chart').getContext('2d');
                let myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: date,
                    datasets: [
                    {
                        label: 'Total Cases',
                        data: total,
                        borderColor: 'rgba(255, 99, 132)',
                        fill: false,
                    },
                    {
                        label: 'Recovered Cases',
                        data: recovered,
                        borderColor: 'rgba(153, 102, 255, 1)',
                        fill: false,
                    },
                    {
                        label: 'Deaths',
                        data: deaths,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        fill: false,
                    },
                    ],
                },
                options: {
                    scales: {
                    yAxes: [
                        {
                        scaleLabel: {
                            display: true,
                            labelString: 'Numbers in Thousands',
                        },
                        },
                    ],
                    xAxes: [
                        {
                        scaleLabel: {
                            display: true,
                            labelString: 'Date(DD/MM/YYYY)',
                        },
                        },
                    ],
                    },
                    title: {
                    display: true,
                    text: `Coronovirus Cases in the World for the last year to current`,
                    },
                },
                });
            })
            .catch((error) => {
                console.log('Error: ', error);
            });
    </script>
  </body>
</html>